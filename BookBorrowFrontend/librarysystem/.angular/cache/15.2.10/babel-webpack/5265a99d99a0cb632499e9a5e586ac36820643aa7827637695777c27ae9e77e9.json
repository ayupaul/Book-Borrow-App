{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet ViewDetailsComponent = class ViewDetailsComponent {\n  constructor(bookService, router, userService, route, userStoreService, toastr) {\n    this.bookService = bookService;\n    this.router = router;\n    this.userService = userService;\n    this.route = route;\n    this.userStoreService = userStoreService;\n    this.toastr = toastr;\n    this.router.params.subscribe(params => {\n      this.bookId = params['id'];\n    });\n  }\n  ngOnInit() {\n    this.bookService.getBookById(this.bookId).subscribe(res => {\n      console.log(res);\n      this.book = res;\n      this.currentRating = this.book.rating;\n      this.bookService.getLentedUserId(this.book.bookId).subscribe(reso => {\n        this.lentByUserId = reso;\n        console.log(reso);\n        this.userService.getUserById(this.lentByUserId).subscribe(resp => {\n          console.log(resp.name);\n          this.lenderName = resp.name;\n          const id = this.userService.getUserIdFromToken();\n          console.log(resp);\n        }, error => {\n          console.log(error);\n        });\n      }, error => {\n        console.log(error);\n      });\n      this.userId = this.userService.getUserIdFromToken();\n    }, error => {\n      console.log(error);\n    });\n  }\n  borrow(bookId) {\n    const userId = this.userService.getUserIdFromToken();\n    this.userService.getAvailableToken(userId).subscribe(resp => {\n      this.avlbToken = resp;\n    });\n    if (this.avlbToken > 0) {\n      if (userId !== this.lentByUserId) {\n        this.bookService.borrowBook(bookId, userId).subscribe(res => {\n          this.route.navigateByUrl(\"/borrowedBooks\");\n        }, error => {\n          console.log(error);\n        });\n      }\n    } else {}\n  }\n};\nViewDetailsComponent = __decorate([Component({\n  selector: 'app-view-details',\n  templateUrl: './view-details.component.html',\n  styleUrls: ['./view-details.component.css']\n})], ViewDetailsComponent);\nexport { ViewDetailsComponent };","map":{"version":3,"mappings":"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","names":["Component","ViewDetailsComponent","constructor","bookService","router","userService","route","userStoreService","toastr","params","subscribe","bookId","ngOnInit","getBookById","res","console","log","book","currentRating","rating","getLentedUserId","reso","lentByUserId","getUserById","resp","name","lenderName","id","getUserIdFromToken","error","userId","borrow","getAvailableToken","avlbToken","borrowBook","navigateByUrl","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["C:\\Users\\ayushpal\\Dotnet-Mini-Assignment2\\BookBorrowFrontend\\librarysystem\\src\\app\\components\\view-details\\view-details.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { BookService } from 'src/app/services/book.service';\nimport { UserStoreService } from 'src/app/services/user-store.service';\nimport { UserService } from 'src/app/services/user.service';\n\n@Component({\n  selector: 'app-view-details',\n  templateUrl: './view-details.component.html',\n  styleUrls: ['./view-details.component.css']\n})\nexport class ViewDetailsComponent implements OnInit {\n  book:any\n  bookId:any\n  lentByUserId:any\n  lenderName:any\n  userId:any\n  currentRating:any\n  avlbToken:any\n  constructor(private bookService:BookService,private router:ActivatedRoute,private userService:UserService,private route:Router,private userStoreService:UserStoreService,private toastr:Toastr){\n    this.router.params.subscribe((params)=>{\n      this.bookId=params['id'];\n    })\n  }\n  ngOnInit(): void {\n    this.bookService.getBookById(this.bookId).subscribe((res)=>{\n      console.log(res);\n      this.book=res;\n      this.currentRating=this.book.rating;\n      this.bookService.getLentedUserId(this.book.bookId).subscribe((reso)=>{\n        this.lentByUserId=reso;\n        console.log(reso);\n        this.userService.getUserById(this.lentByUserId).subscribe((resp)=>{\n          console.log(resp.name);\n          this.lenderName=resp.name;\n          const id=this.userService.getUserIdFromToken();\n          \n          console.log(resp);\n        },(error)=>{\n          console.log(error);\n        })\n      },(error)=>{\n        console.log(error);\n      })\n    \n      this.userId=this.userService.getUserIdFromToken();\n      \n    },(error)=>{\n      console.log(error);\n    })\n   \n  }\n  borrow(bookId:any){\n    const userId=this.userService.getUserIdFromToken();\n    this.userService.getAvailableToken(userId).subscribe((resp)=>{\n      this.avlbToken=resp;\n    })\n    if(this.avlbToken>0){\n    if(userId!==this.lentByUserId){\n    this.bookService.borrowBook(bookId,userId).subscribe((res)=>{\n      this.route.navigateByUrl(\"/borrowedBooks\");\n    \n    },(error)=>{\n      console.log(error);\n    })\n  }\n}\nelse{\n  \n}\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}