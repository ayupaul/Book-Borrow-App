{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/book.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"src/app/services/user.service\";\nimport * as i4 from \"src/app/services/user-store.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@ng-bootstrap/ng-bootstrap\";\nfunction ViewDetailsComponent_a_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 9);\n    i0.ɵɵtext(1, \"Lender cannot borrow\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ViewDetailsComponent_a_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"a\", 10);\n    i0.ɵɵlistener(\"click\", function ViewDetailsComponent_a_11_Template_a_click_0_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.borrow(ctx_r2.book.bookId));\n    });\n    i0.ɵɵtext(1, \"Borrow this book\");\n    i0.ɵɵelementEnd();\n  }\n}\nexport class ViewDetailsComponent {\n  constructor(bookService, router, userService, route, userStoreService) {\n    this.bookService = bookService;\n    this.router = router;\n    this.userService = userService;\n    this.route = route;\n    this.userStoreService = userStoreService;\n    this.router.params.subscribe(params => {\n      this.bookId = params['id'];\n    });\n  }\n  ngOnInit() {\n    this.bookService.getBookById(this.bookId).subscribe(res => {\n      console.log(res);\n      this.book = res;\n      this.currentRating = this.book.rating;\n      this.bookService.getLentedUserId(this.book.bookId).subscribe(reso => {\n        this.lentByUserId = reso;\n        console.log(reso);\n        this.userService.getUserById(this.lentByUserId).subscribe(resp => {\n          console.log(resp.name);\n          this.lenderName = resp.name;\n          const id = this.userService.getUserIdFromToken();\n          console.log(resp);\n        }, error => {\n          console.log(error);\n        });\n      }, error => {\n        console.log(error);\n      });\n      this.userId = this.userService.getUserIdFromToken();\n    }, error => {\n      console.log(error);\n    });\n  }\n  borrow(bookId) {\n    const userId = this.userService.getUserIdFromToken();\n    this.userService.getAvailableToken();\n    if (userId !== this.lentByUserId) {\n      this.bookService.borrowBook(bookId, userId).subscribe(res => {\n        this.route.navigateByUrl(\"/borrowedBooks\");\n      }, error => {\n        console.log(error);\n      });\n    }\n  }\n  static #_ = this.ɵfac = function ViewDetailsComponent_Factory(t) {\n    return new (t || ViewDetailsComponent)(i0.ɵɵdirectiveInject(i1.BookService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i3.UserService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i4.UserStoreService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ViewDetailsComponent,\n    selectors: [[\"app-view-details\"]],\n    decls: 14,\n    vars: 10,\n    consts: [[1, \"card\", \"text-center\"], [1, \"card-header\"], [1, \"card-body\"], [1, \"card-title\"], [1, \"card-text\"], [\"class\", \"btn btn-danger\", 4, \"ngIf\"], [\"class\", \"btn btn-primary\", 3, \"click\", 4, \"ngIf\"], [1, \"card-footer\", \"text-body-secondary\"], [2, \"color\", \"goldenrod\", 3, \"max\", \"rate\", \"readonly\"], [1, \"btn\", \"btn-danger\"], [1, \"btn\", \"btn-primary\", 3, \"click\"]],\n    template: function ViewDetailsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵtext(2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 2)(4, \"h5\", 3);\n        i0.ɵɵtext(5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"p\", 4);\n        i0.ɵɵtext(7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"p\", 4);\n        i0.ɵɵtext(9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(10, ViewDetailsComponent_a_10_Template, 2, 0, \"a\", 5);\n        i0.ɵɵtemplate(11, ViewDetailsComponent_a_11_Template, 2, 0, \"a\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"div\", 7);\n        i0.ɵɵelement(13, \"ngb-rating\", 8);\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate2(\" \", ctx.book.description, \" by \", ctx.book.author, \" \");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.book.bookName);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.book.genre);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\"Lender Name:\", ctx.lenderName, \"\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.lentByUserId == ctx.userId);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.lentByUserId != ctx.userId);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"max\", 5)(\"rate\", ctx.currentRating)(\"readonly\", true);\n      }\n    },\n    dependencies: [i5.NgIf, i6.NgbRating],\n    styles: [\".card[_ngcontent-%COMP%]{\\r\\n    width: 800px;\\r\\n    margin-left: 200px;\\r\\n   margin-top: 50px;\\r\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy92aWV3LWRldGFpbHMvdmlldy1kZXRhaWxzLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxZQUFZO0lBQ1osa0JBQWtCO0dBQ25CLGdCQUFnQjtBQUNuQiIsInNvdXJjZXNDb250ZW50IjpbIi5jYXJke1xyXG4gICAgd2lkdGg6IDgwMHB4O1xyXG4gICAgbWFyZ2luLWxlZnQ6IDIwMHB4O1xyXG4gICBtYXJnaW4tdG9wOiA1MHB4O1xyXG59Il0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["i0","ViewDetailsComponent","constructor","bookService","router","userService","route","userStoreService","params","subscribe","bookId","ngOnInit","getBookById","res","console","log","book","currentRating","rating","getLentedUserId","reso","lentByUserId","getUserById","resp","name","lenderName","id","getUserIdFromToken","error","userId","borrow","getAvailableToken","borrowBook","navigateByUrl","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\ayushpal\\Dotnet-Mini-Assignment2\\BookBorrowFrontend\\librarysystem\\src\\app\\components\\view-details\\view-details.component.html","C:\\Users\\ayushpal\\Dotnet-Mini-Assignment2\\BookBorrowFrontend\\librarysystem\\src\\app\\components\\view-details\\view-details.component.ts"],"sourcesContent":["<div class=\"card text-center\">\n    <div class=\"card-header\">\n      {{book.description}} by {{book.author}}\n    </div>\n    <div class=\"card-body\">\n      <h5 class=\"card-title\">{{book.bookName}}</h5>\n      <p class=\"card-text\">{{book.genre}}</p>\n      <p class=\"card-text\">Lender Name:{{lenderName}}</p>\n      <a *ngIf=\"lentByUserId==userId\" class=\"btn btn-danger\">Lender cannot borrow</a>\n      <a *ngIf=\"lentByUserId!=userId\" class=\"btn btn-primary\" (click)=\"borrow(book.bookId)\">Borrow this book</a>\n    </div>\n    <div class=\"card-footer text-body-secondary\">\n      <ngb-rating [max]=\"5\" [rate]=\"currentRating\" [readonly]=\"true\" style=\"color: goldenrod\"></ngb-rating>\n\n    </div>\n  </div>\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { BookService } from 'src/app/services/book.service';\nimport { UserStoreService } from 'src/app/services/user-store.service';\nimport { UserService } from 'src/app/services/user.service';\n\n@Component({\n  selector: 'app-view-details',\n  templateUrl: './view-details.component.html',\n  styleUrls: ['./view-details.component.css']\n})\nexport class ViewDetailsComponent implements OnInit {\n  book:any\n  bookId:any\n  lentByUserId:any\n  lenderName:any\n  userId:any\n  currentRating:any\n  constructor(private bookService:BookService,private router:ActivatedRoute,private userService:UserService,private route:Router,private userStoreService:UserStoreService){\n    this.router.params.subscribe((params)=>{\n      this.bookId=params['id'];\n    })\n  }\n  ngOnInit(): void {\n    this.bookService.getBookById(this.bookId).subscribe((res)=>{\n      console.log(res);\n      this.book=res;\n      this.currentRating=this.book.rating;\n      this.bookService.getLentedUserId(this.book.bookId).subscribe((reso)=>{\n        this.lentByUserId=reso;\n        console.log(reso);\n        this.userService.getUserById(this.lentByUserId).subscribe((resp)=>{\n          console.log(resp.name);\n          this.lenderName=resp.name;\n          const id=this.userService.getUserIdFromToken();\n          \n          console.log(resp);\n        },(error)=>{\n          console.log(error);\n        })\n      },(error)=>{\n        console.log(error);\n      })\n    \n      this.userId=this.userService.getUserIdFromToken();\n      \n    },(error)=>{\n      console.log(error);\n    })\n   \n  }\n  borrow(bookId:any){\n    const userId=this.userService.getUserIdFromToken();\n    this.userService.getAvailableToken()\n    if(userId!==this.lentByUserId){\n    this.bookService.borrowBook(bookId,userId).subscribe((res)=>{\n      this.route.navigateByUrl(\"/borrowedBooks\");\n    \n    },(error)=>{\n      console.log(error);\n    })\n  }\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}